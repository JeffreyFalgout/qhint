<!doctype html>
<html>
<head>
    <title>qHint tests</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <link rel="stylesheet" href="../qunit/qunit/qunit.css" media="screen" />
    <script src="../qunit/qunit/qunit.js"></script>
    <script src="../jshint/jshint.js"></script>
    <script src="../qhint.js"></script>

    <script>
        var jsHintArgs, asyncTestArgs;

        (function() {
            var oldAsyncTest, oldJsHint, oldSendRequest;

            module("Functionality", {
                setup: function() {
                    oldAsyncTest = asyncTest;
                    oldJsHint = JSHINT;

                    jsHintArgs = [];
                    asyncTestArgs = [];

                    JSHINT = function() {
                        jsHintArgs = arguments;

                        return true;
                    };

                    asyncTest = function(name, f) {
                        asyncTestArgs = arguments;
                        f();
                    };

                    qHint.sendRequest = function(url, callback) {
                        callback({
                            status: 200,
                            sourceFile: url,
                            responseText: "var a = 1;"
                        });
                    };
                },
                teardown: function() {
                    asyncTest = oldAsyncTest;
                    JSHINT = oldJsHint;

                }
            });
        })();

        test("calls with one parameter uses it as test name", function() {
            jsHintTest("foo.js");

            equal(asyncTestArgs[0], "foo.js");
        });

        test("passes options to jsHint", function() {
            var options = {
                    eqeqeq: false
                };

            jsHintTest("foo.js", options);

            same(jsHintArgs[1], options);
        });

        module("Style");

        jsHintTest("qHinting qHint", "../qhint.js");
    </script>
</head>
<body>
    <h1 id="qunit-header">QUnit tests</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup, will be hidden</div>
</body>
</html>

